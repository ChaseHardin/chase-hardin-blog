{"data":{"markdownRemark":{"html":"<p>The builder pattern is one of my go-toâ€™s when programming. It makes data setup extremely easy - instantiate a class, chain some methods together, and finish by executing a build or execute method. However, every time I write a builder class, I canâ€™t help but wonder if thereâ€™s a more functional approach that completely removes state. This of course is on the forefront of my mind since my contract relates to writing React and utilizing pure components.</p>\n<h2>What are we building? ðŸ› </h2>\n<p>Imagine youâ€™re a woodworker who builds tables as a side business. When a client inquires about a dining room table, we need to collect their information, keep track of the table dimensions, and calculate how much weâ€™d charge to build the table. This can be a time consuming process without software. To quickly generate an estimate, letâ€™s create a simple builder thatâ€™ll handle most of the work for us. </p>\n<p><i>This example will be fairly trivial, but the concepts are still applicable on larger scaled apps.</i></p>\n<h2>Ready to see some code? ðŸ¤“</h2>\n<p>Before we deep dive into the details, letâ€™s look at how weâ€™d utilize the functions to build up our state object. First, we need to create functions that handle adding a client, dimensions, and expenses. For the sake of simplicity, Iâ€™ve created an <i>addExpense</i> function that handles how expenses are generated that way we focus more on concepts vs implementation details.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n    setupData<span class=\"token punctuation\">,</span>\n    addClient<span class=\"token punctuation\">,</span>\n    addDimensions<span class=\"token punctuation\">,</span>\n    addExpenses<span class=\"token punctuation\">,</span>\n    calculatePrice\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./data-helpers'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token function\">addClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    firstName<span class=\"token punctuation\">:</span> <span class=\"token string\">'John'</span><span class=\"token punctuation\">,</span>\n    lastName<span class=\"token punctuation\">:</span> <span class=\"token string\">'Smith'</span><span class=\"token punctuation\">,</span>\n    email<span class=\"token punctuation\">:</span> <span class=\"token string\">'johnsmith@email.com'</span><span class=\"token punctuation\">,</span>\n    phone<span class=\"token punctuation\">:</span> <span class=\"token string\">'555-555-5555'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> dimensions <span class=\"token operator\">=</span> <span class=\"token function\">addDimensions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    width<span class=\"token punctuation\">:</span> <span class=\"token string\">'3ft'</span><span class=\"token punctuation\">,</span>\n    length<span class=\"token punctuation\">:</span> <span class=\"token string\">'6ft'</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token punctuation\">:</span> <span class=\"token string\">'30in'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> expenses <span class=\"token operator\">=</span> <span class=\"token function\">addExpenses</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    estimatedHours<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n    materialCosts<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>These functions take an object parameter and set the details. We can then use these functions together by chaining them with the <i>setupData</i> helper. The important thing to note from this snippet is that our <i>setupData</i> function will pass the returned result from one function to the next. </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>state<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">setupData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    client<span class=\"token punctuation\">,</span>\n    dimensions<span class=\"token punctuation\">,</span>\n    expenses<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">calculatePrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Letâ€™s take a closer look ðŸ”Ž</h2>\n<p>In a typical class builder scenario, we'd build up our state by calling multiple methods on our instantiated class. To achieve this functionally, we want to build up our data object, but also want to avoid creating classes. An easy way to go about this is to utilize the <i>flow</i> function from <code class=\"language-text\">lodash</code>. While we could go to the trouble of writing our own, I like the idea of using open source frameworks. With that in mind, the <i>flow</i> function takes an array of functions and allows us to specify the initial state. Flow will take the returned value from each function and pass it along to the next function in the chain. More details can be found <a href=\"https://lodash.com/docs/4.17.15#flow\">here</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> flow <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash/flow'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">setupData</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>dataBuilders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token function\">flow</span><span class=\"token punctuation\">(</span>dataBuilders<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>initialState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        state\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now that we have the <code class=\"language-text\">setupData</code> function completed, we are ready to start adding the data builder functions. They're all fairly similar so let's start by focusing on the <code class=\"language-text\">addClient</code> function. Take a minute to review what this snippet is doing.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">addClient</span> <span class=\"token operator\">=</span> client <span class=\"token operator\">=></span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> client<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>While this function is only one line of code, there's a lot going on. This function is leveraging a functional programing concept known as <i>currying</i>. It allows us to return a new function for each argument in the line while also using closure to keep the arguments alive. To provide a more concrete example, let's talk through the <code class=\"language-text\">addClient</code> function. This function passes the <code class=\"language-text\">client</code> argument and returns a new function. The second argument in the line is <code class=\"language-text\">state</code>. We have access to this because when used in conjunction with <code class=\"language-text\">flow</code>, it passes the returned value from the function previously executed. In our case, the state from the previous function or initial state if used first. Here are a few more examples of the data helpers.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">addDimensions</span> <span class=\"token operator\">=</span> dimensions <span class=\"token operator\">=></span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> dimensions<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">addExpenses</span> <span class=\"token operator\">=</span> expenses <span class=\"token operator\">=></span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> expenses<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">calculatePrice</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> hourlyRate <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>estimatedHours<span class=\"token punctuation\">,</span> materialCosts<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>expenses<span class=\"token punctuation\">;</span>\n\n    state<span class=\"token punctuation\">.</span>calculatedPrice <span class=\"token operator\">=</span> estimatedHours <span class=\"token operator\">*</span> hourlyRate <span class=\"token operator\">+</span> materialCosts<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>If this topic is still a bit fuzzy, don't worry. Check out <a href=\"https://mostly-adequate.gitbooks.io/mostly-adequate-guide/ch04.html\">this</a> is a great resource.</p>\n<h2>Conclusion</h2>\n<p>The builder pattern is extremely helpful. If you're comfortable with the class style builder and like that pattern best, great! However, if you're running into issues with side effects, mutation, or class level state, I hope you'll give the functional builders a try. </p>\n<p>Feel free to comment or send me a message if you have any questions/feedback!</p>","frontmatter":{"title":"A Functional Approach to The Builder Pattern"}}},"pageContext":{"slug":"/builder-pattern/"}}